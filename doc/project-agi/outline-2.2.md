# Phase 2.2: 倫理的透明性の確保 (Ensuring Ethical Transparency)

## 関連Issue (Associated Issues)
- [#19](https://github.com/MicrocomputerTechnology/SigmaSenseJp/issues/19): 【提案】倫理フィルター(aegis_ethics_filter)の判断プロセスにおける説明可能性(XAI)の欠如

## 1. 設計目標 (Design Goals)
- 倫理フィルター(Aegis)の意思決定プロセスを完全に透明化し、開発者がその判断根拠を理解・追跡・監査できるようにする。
- 「なぜその行動が許可/ブロックされたのか」という問いに、システムが明確に答えられるようにする。

## 2. 設計概要 (Design Overview)
- **判断ロギング機能の実装:**
  - `aegis_ethics_filter.py`を改修し、倫理的判断が下されるたびに、構造化されたログを生成する。
  - ログには、`[タイムスタンプ, 判断対象のコンテキスト, 適用された倫理ルールID, 判断結果(許可/ブロック), 判断理由の自然言語記述]`を含める。
  - ログは専用の `aegis_log.jsonl` のようなファイルに出力する。

- **倫理原則の明文化:**
  - `/doc` ディレクトリに `ETHICS.md` を作成し、Aegisが準拠する倫理原則（例：功利主義、義務論、プロジェクト固有の規範）を階層的にリストアップする。各原則には一意のIDを付与する。
  - 倫理フィルターのコード内で、特定のロジックがどの倫理原則IDに対応するのかをコメントで明記する。

- **説明インターフェース(API)の開発:**
  - `Aegis`モジュールに、`explain_decision(context)`という新しいメソッドを追加する。
  - このメソッドは、特定の状況（コンテキスト）を入力として受け取り、その状況下で下されるであろう判断と、その根拠となる倫理原則を返す。これにより、開発者は「What-if」分析を容易に行えるようになる。

## 3. 主要な課題と検討事項 (Key Challenges & Considerations)
- **パフォーマンスへの影響:** すべての判断で詳細なログを生成することは、システムのパフォーマンスに影響を与える可能性がある。ログレベルの導入や、非同期での書き込みを検討する。
- **説明の粒度:** ログや説明が冗長すぎると、かえって分析が困難になる。人間が理解しやすい、適切な粒度と抽象度で説明を生成する必要がある。

## 4. 期待される成果 (Expected Outcome)
- 倫理フィルターの判断がブラックボックスでなくなり、デバッグと改善が容易になる。
- システムの倫理的な安全性を、客観的なログとドキュメントに基づいて証明できるようになる。
- 開発者がエージェントの倫理的挙動に高い信頼を置けるようになる。

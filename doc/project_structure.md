## 7. 付録A：プロジェクトファイル構成

本プロジェクトを構成する主要なファイルとディレクトリを、その機能単位で分類します。

### A. 実行スクリプト
システムの主要な動作を開始するためのエントリーポイント群です。

- `run_sigma.py`: 第十五次世代の思考サイクル（`process_experience`）を実行するメインスクリプト。
- `run_learning_objective.py`: 外部から与えられた学習目標を処理するワークフローを開始します。
- `run_sheaf_analysis.py`: 画像内の局所的な特徴が、層理論の貼り合わせ条件を満たしているか（矛盾がないか）を検証します。

### B. コアエンジン
SigmaSenseの思考と判断の中核を担うモジュール群です。

- `sigma_sense.py`: **第十五次世代 統合思考オーケストレータ**。システムの心臓部であり、`process_experience`関数を通じて、知覚から学習、自己言及に至る一連の思考サイクルを制御します。
- `sigma_functor.py`: 圏論に基づき、システムの論理的整合性（関手性）を検証します。
- `dimension_loader.py`: 複数の次元定義ファイル（JSON, YAML）を横断的に読み込み、システム全体に統一された次元空間を提供します。
- `symbolic_reasoner.py`: `WorldModel`（動적知識グラフ）に記録された常識（例: 「猫は動物である」）を利用し、観測された特徴に論理的な制約を与えます。
- `logical_pattern_suggester.py`: 観測された特徴ベクトルから、「これは円かもしれない」「赤色が優勢である」といった仮説をゼロショットで生成し、推論の出発点を提供します。
- `contextual_override_engine.py`: 一般的なルールに対する例外（例: 「ペンギンは鳥だが飛べない」）を適用し、推論の矛盾を解消します。
- `narrative_justifier.py`: `WorldModel`と`PersonalMemoryGraph`を参照し、特定の判断がどのような知識と過去の経験に基づいていたかを説明する「意図の語り」を生成する機能に特化しています。
- `match_predictor.py`: `FastMatchPredictor` を内包し、データベース内の膨大なベクトルから、類似している可能性が高い候補を高速に絞り込みます。
- `build_database.py`: プロジェクト内の全画像からベクトルデータベースを構築します。

### C. 自己省察・記憶・学習
第十五次実験で導入された、自己意識と思考のサイクルを支えるコンポーネント群。

- `world_model.py`: **動的知識グラフ**。世界の概念（ノード）とその関係性（エッジ）を記録します。このグラフは、`CausalDiscovery`による学習を通じて自律的に更新され、システムの「常識」を形成します。
- `personal_memory_graph.py`: **個人的な経験の記憶**。`process_experience`の一回の実行（知覚〜判断）を一つの「経験」ノードとして記録します。入力、中間生成物、最終結果、利用した知識などが関連付けられ、後の自己省察の材料となります。
- `meta_narrator.py`: **成長の語り手**。`PersonalMemoryGraph`に蓄積された全経験を分析し、自己の成長（例: 新しい概念の獲得）や心理状態の変化を物語として生成します。
- `causal_discovery.py`: **因果発見エンジン**。蓄積された記憶を統計的に分析し、「特定の形状と特定の色彩が同時に現れることが多い」といった新たな因果関係のルールを発見して`WorldModel`を更新します。
- `temporal_reasoning.py`: **時間的推論エンジン**。記憶のシーケンスを分析し、「イベントAの後にはイベントBが起こりやすい」といった時間的なパターンを発見して`WorldModel`を更新します。

### D. 自己拡張・学習
未知のタスクに適応し、能力を恒久化するための三段階処理（即応・即興・構造化）を担うモジュール群です。

- `temporary_handler_base.py`: 臨時ハンドラの基底クラス。
- `handlers/`: 恒久化されたスキル（ハンドラ）が`.py`ファイルとして保存されるディレクトリ。

### E. 知性モジュール
システムの「思考」を司る、換装可能な知性エージェント群です。

- **E1. オンライン知性 (オリエン)**
  - `gemini_client.py`: Gemini APIとの通信を担い、意味次元の設計など高度な帰納的推論を実行します。
- **E2. オフライン知性 (ヴェトラ)**
  - `sigma_local_core.py`: オフライン時の思考プロセス全体を制御する「脳」。
- `sheaf_analyzer.py`: **層理論アナライザー**。画像の複数領域から得られた特徴ベクトルが、その重複部分で整合的であるか（貼り合わせ可能か）を検証する。

### F. 意味ベクトル生成
画像という生のデータから、意味を持つベクトル空間へと変換するモジュール群です。

- `dimension_generator_local.py`: **統合特徴生成器**。複数のエンジンを並列で呼び出し、特徴量とその出所（Provenance）を含むオブジェクトを返す。
- `sigma_image_engines/`: `engine_opencv.py`, `engine_efficientnet.py` など、具体的な特徴抽出を行う個別のエンジン群。

### G. 倫理・メタ認知 (Ethics & Metacognition)
第十六次実験で導入された「八人の誓い」と、システムの自己認識を支えるモジュール群。

- `ethical_filter.py`: **オリエンの誓い**。語りの安全性を検証し、不適切な内容を検知・無害化する。
- `publication_gatekeeper.py`: **イージスの誓い**。ミッションプロファイルに基づき、語りの公開可否を判断する。
- `contextual_compassion.py`: **ヴェトラ先生の誓い**。文脈を読み取り、語りに共感的なトーンを加える。
- `emotion_balancer.py`: **レイラの誓い**。システム自身の心理状態に応じて、語りに感情的なニュアンスを付与する。
- `meaning_axis_designer.py`: **サフィールの誓い**。`GiNZA`を利用して語りの意味的なバランスを評価し、偏りを警告する。
- `instinct_monitor.py`: **犬のシグマセンスの誓い**。語りの長さの異常性を監視し、普段と異なるパターンを警告する。
- `growth_tracker.py`: **ノヴァの誓い**。`GiNZA`を利用して過去の語りと比較し、新しい概念の獲得という「成長」を記録する。
- `narrative_integrity.py`: **セリアの誓い**。語りの出典（経験ID、主要概念）を記録し、追跡可能性を保証する。
- `toyokawa_model.py`: **豊川モデル**。システム全体の活動から「心理状態」を定量的に観測するメタ認知モジュール。

### H. データ & 設定ファイル
システムの動作を定義し、知識を記録する非コード資産です。

- `world_model.json`: **動的知識グラフ**。世界の概念と、学習によって発見された因果関係が記録される。
- `personal_memory.jsonl`: **個人記憶ログ**。全ての経験が時系列で記録される、自己省察の源泉。
- `vector_dimensions_*.json`, `vector_dimensions_*.yaml`: 各知性・各レイヤーが使用する意味次元の設計図。
- `sigma_product_database_*.json`: 生成された意味ベクトルが格納されるデータベース。
- `common_sense_rulebase.json`: `SymbolicReasoner` が使用していた静的ルールブック（第十五次実験で`world_model.json`に移行）。

### I. ツール & ユーティリティ
開発、分析、テストを補助するためのスクリプト群です。

- `tools/`: 各種分析・評価ツールが格納されるディレクトリ。
- `run_ethics_check_on_text.py`: 外部テキストに対して倫理チェックを実行するテストスクリプト。
- `generate_test_image.py`: 検証用の画像を生成します。